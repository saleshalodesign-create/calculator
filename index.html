<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signage Pricing Calculator</title>
    
    <!-- 引入 Space Mono 字体（数字风格） -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght400;700&display=swap" rel="stylesheet">
    
    <!-- Load Tailwind CSS with 'class' dark mode strategy -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configuration to enable dark mode based on the 'dark' class on the HTML tag
        tailwind.config = {
            darkMode: 'class', 
        }
    </script>
    
    <style>
        /* === Base Global Styles & Font === */
        body {
            /* 应用 Space Mono 字体，增强计算器或数字显示屏的视觉效果 */
            font-family: 'Space Mono', monospace;
        }

        /* New: Rainbow Background Animation Keyframes */
        @keyframes rainbow-bg {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Apply rainbow background only in LIGHT MODE (when html does NOT have the 'dark' class) */
        html:not(.dark) body {
            /* Define a large, animated gradient */
            background: linear-gradient(-45deg, #FF6F61, #FFC75F, #84A98C, #4C9A84, #5D5FEF, #B15FEF);
            background-size: 600% 600%; 
            /* Animation cycle is 10 seconds (slower, as requested) */
            animation: rainbow-bg 10s ease infinite; 
            /* Ensure the static background is overridden */
            background-color: transparent !important;
        }
        
        /* UPDATED: Apply noticeable pastel rainbow animation to the main container in light mode */
        html:not(.dark) #mainContainer {
            /* Define a more visible pastel gradient with subtle color shifts */
            background: linear-gradient(-45deg, #fef0f8, #fff8f0, #f0fff0, #f0f8ff, #f8f0ff);
            background-size: 600% 600%; 
            /* Even slower transition for the calculator box */
            animation: rainbow-bg 25s ease infinite reverse; 
            /* Remove the default border in light mode for a cleaner look with the animation */
            border: none;
            /* Enhance shadow in light mode for floating effect */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.3);
        }
        
        /* Smooth transition for theme change on all elements */
        * {
            transition-property: background-color, color, border-color, transform, opacity, box-shadow;
            transition-duration: 500ms;
            transition-timing-function: ease-in-out;
        }

        /* === Page Entrance Animation Styles (保留) === */
        /* Initial state: transparent and slightly offset down */
        .page-enter-start {
            opacity: 0;
            transform: translateY(20px);
        }
        /* Transition properties */
        .page-transition {
            transition: opacity 700ms ease-out, transform 700ms ease-out;
        }
        /* Final state: fully visible and in place */
        .page-enter-end {
            opacity: 1;
            transform: translateY(0);
        }

        /* Modal Transitions */
        .modal-enter { opacity: 0; transform: scale(0.9); }
        .modal-enter-active { opacity: 1; transform: scale(1); transition: opacity 300ms, transform 300ms; }
        .modal-exit { opacity: 1; transform: scale(1); }
        .modal-exit-active { opacity: 0; transform: scale(0.9); transition: opacity 300ms, transform 300ms; }
        
        /* === Watermark Styling for Dynamic Mode === */
        #results, #modalContent { position: relative; overflow: hidden; }

        #results::before, #modalContent::before {
            content: "HALO DESIGN HUB";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-25deg);
            font-size: 3.5rem; 
            font-weight: 900;
            white-space: nowrap; 
            z-index: 0; 
            pointer-events: none; 
            line-height: 1;
            
            /* Dynamic Watermark Color (Light Mode Default) */
            color: #d1d5db; /* Gray-300 */
            opacity: 0.25;
        }
        
        /* Dark Mode Watermark Color Adjustment */
        html.dark #results::before, html.dark #modalContent::before {
            color: #4b5563; /* Gray-600 */
            opacity: 0.1; 
        }
    </style>
</head>

<!-- Body: Controls global background and text color. -->
<body class="p-4 sm:p-8 flex justify-center items-start min-h-screen 
             text-gray-900 dark:bg-gray-900 dark:text-gray-200"> 

    <!-- Main Container: Card background and border styles -->
    <!-- Removed bg-white and border-gray-200 to allow CSS animated light mode background to work -->
    <div id="mainContainer" 
         class="w-full max-w-xl shadow-2xl rounded-xl p-6 sm:p-10 border 
                dark:bg-gray-800 
                dark:border-gray-700 
                page-enter-start">
        
        <!-- Header Section with Logo and Theme Toggle -->
        <div class="flex justify-between items-start mb-8 w-full">
            <!-- Logo Block -->
            <div class="flex flex-col items-start">
                <div class="flex items-end h-16" style="line-height: 1;">
                    <!-- 'hal' Text: Dynamic color -->
                    <span class="text-gray-900 dark:text-white text-6xl font-black tracking-tighter leading-none" style="font-family: 'Space Mono', monospace;">hal</span>
                    
                    <!-- Icon: Dynamic Outline/Fill -->
                    <div class="flex items-center justify-center -ml-0.5 -mt-2">
                        <svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                            <!-- Outer Ring: Dynamic Stroke -->
                            <circle cx="30" cy="30" r="28" stroke="#374151" class="dark:stroke-[#d1d5db]" stroke-width="4" fill="none"/>
                            <!-- Inner Circle: Neon Green (Accent color remains constant) -->
                            <circle cx="30" cy="30" r="24" fill="#aee236"/> 
                        </svg>
                    </div>
                </div>
                <!-- Sub Text (DESIGN HUB): Muted light gray -->
                <div class="text-gray-400 text-sm font-semibold tracking-widest mt-0.5" style="font-family: 'Space Mono', monospace;">
                    DESIGN HUB
                </div>
            </div>

            <!-- Theme Toggle Button -->
            <button id="themeToggle" onclick="toggleTheme()" 
                    class="p-3 rounded-full text-gray-500 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition duration-300 transform hover:scale-110">
                <!-- Sun Icon (Light Mode) -->
                <svg id="sunIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                <!-- Moon Icon (Dark Mode) -->
                <svg id="moonIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                </svg>
            </button>
        </div>

        <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-600 dark:text-blue-400 mb-6 text-center">Signage Pricing</h1>
        
        <!-- Main Conversion Input Area: Dynamic BG/Border -->
        <!-- UPDATED: Removed bg-gray-100 to allow parent's animated background to show through in light mode. -->
        <div class="space-y-6 mb-10 p-6 rounded-xl shadow-inner 
                    dark:bg-gray-700 
                    border border-gray-300 dark:border-gray-600">
             
            <!-- Unit Selector -->
            <div>
                <label for="unit" class="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2">
                    Measurement Unit
                </label>
                <select id="unit" onchange="calculatePricing()"
                        class="w-full p-4 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg transition duration-150 shadow-sm 
                               bg-white dark:bg-gray-900 text-gray-800 dark:text-white border border-gray-300 dark:border-gray-600">
                    <option value="in">Inches (in)</option>
                    <option value="ft">Feet (ft)</option>
                    <option value="cm">Centimeters (cm)</option>
                    <option value="mm">Millimeters (mm)</option>
                </select>
            </div>

            <!-- Width Input -->
            <div>
                <label for="width" class="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2">
                    Width (W)
                </label>
                <div class="mt-1 relative rounded-lg shadow-sm">
                    <input type="number" id="width" min="0" value="117"
                           oninput="calculatePricing()"
                           class="w-full p-4 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg transition duration-150 
                                  bg-white dark:bg-gray-900 text-gray-800 dark:text-white border border-gray-300 dark:border-gray-600"
                           placeholder="e.g., 112">
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                        <span class="text-gray-400 sm:text-sm" id="widthUnitLabel">in</span>
                    </div>
                </div>
            </div>

            <!-- Height Input -->
            <div>
                <label for="height" class="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2">
                    Height (H)
                </label>
                <div class="mt-1 relative rounded-lg shadow-sm">
                    <input type="number" id="height" min="0" value="30"
                           oninput="calculatePricing()"
                           class="w-full p-4 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg transition duration-150 
                                  bg-white dark:bg-gray-900 text-gray-800 dark:text-white border border-gray-300 dark:border-gray-600"
                           placeholder="e.g., 30">
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                        <span class="text-gray-400 sm:text-sm" id="heightUnitLabel">in</span>
                    </div>
                </div>
            </div>
            
            <!-- Conversion Results: Dynamic BG/Border/Text -->
            <div id="conversionResults" class="mt-4 p-4 rounded-lg 
                                               bg-white dark:bg-gray-900 text-blue-600 dark:text-blue-400 
                                               border border-gray-300 dark:border-gray-600">
                <h3 class="font-semibold text-base mb-2 text-gray-600 dark:text-gray-300">Converted Dimensions (for 117 x 30 in)</h3>
                <ul class="text-xs grid grid-cols-2 gap-x-4 gap-y-1 text-gray-500 dark:text-gray-400">
                    <li><strong class="font-medium text-blue-600 dark:text-blue-400">W (ft):</strong> <span id="w_ft">0.00 ft</span></li>
                    <li><strong class="font-medium text-blue-600 dark:text-blue-400">H (ft):</strong> <span id="h_ft">0.00 ft</span></li>
                    <li><strong class="font-medium text-blue-600 dark:text-blue-400">W (cm):</strong> <span id="w_cm">0.00 cm</span></li>
                    <li><strong class="font-medium text-blue-600 dark:text-blue-400">H (cm):</strong> <span id="h_cm">0.00 cm</span></li>
                    <li><strong class="font-medium text-blue-600 dark:text-blue-400">W (mm):</strong> <span id="w_mm">0.00 mm</span></li>
                    <li><strong class="font-medium text-blue-600 dark:text-blue-400">H (mm):</strong> <span id="h_mm">0.00 mm</span></li>
                </ul>
            </div>
        </div>


        <!-- Pricing Results Display -->
        <div id="results" class="space-y-4 pt-6 border-t border-gray-300 dark:border-gray-700">
            <h2 class="text-xl font-bold text-gray-700 dark:text-gray-200">Calculated Prices</h2>
            <p class="text-sm text-gray-500 dark:text-gray-400" id="areaDisplay"></p>

            <!-- Result Cards: Dynamic BG/Text/Border -->
            
            <!-- Lightbox w Backlit Result Card ($85/sq ft) - Gold/Accent Card (Highest Tier) -->
            <div onclick="showQuotation('Lightbox w Backlit', 85, document.getElementById('lightboxOnlyPrice').textContent)"
                 class="bg-white dark:bg-gray-700 p-5 rounded-xl shadow-lg flex justify-between items-center transition duration-300 transform hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] active:shadow-lg cursor-pointer border-l-4 border-yellow-600 dark:border-yellow-500">
                <span class="font-semibold text-lg text-yellow-600 dark:text-yellow-400">Lightbox w Backlit ($85/sq ft)</span>
                <span id="lightboxOnlyPrice" class="text-2xl font-extrabold text-yellow-700 dark:text-yellow-500">$0.00</span>
            </div>
            
            <!-- Lightbox Only Result Card ($50/sq ft) -->
            <div onclick="showQuotation('Lightbox Only', 50, document.getElementById('lightboxStandardPrice').textContent)"
                 class="bg-white dark:bg-gray-700 p-5 rounded-xl shadow-md flex justify-between items-center transition duration-300 transform hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] active:shadow-lg cursor-pointer border-l-4 border-blue-600 dark:border-blue-500">
                <span class="font-semibold text-lg text-blue-600 dark:text-blue-400">Lightbox Only ($50/sq ft)</span>
                <span id="lightboxStandardPrice" class="text-2xl font-extrabold text-blue-700 dark:text-blue-500">$0.00</span>
            </div>

            <!-- Backlit Only Result Card ($35/sq ft) -->
            <div onclick="showQuotation('Backlit Only', 35, document.getElementById('backlitPrice').textContent)"
                 class="bg-white dark:bg-gray-700 p-5 rounded-xl shadow-md flex justify-between items-center transition duration-300 transform hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] active:shadow-lg cursor-pointer border-l-4 border-gray-500 dark:border-gray-400">
                <span class="font-semibold text-lg text-gray-600 dark:text-gray-300">Backlit Only ($35/sq ft)</span>
                <span id="backlitPrice" class="text-2xl font-extrabold text-gray-700 dark:text-gray-400">$0.00</span>
            </div>
            
            <!-- Vinyl Result Card ($20/sq ft) -->
            <div onclick="showQuotation('Vinyl Graphics', 20, document.getElementById('vinylPrice').textContent)"
                 class="bg-white dark:bg-gray-700 p-5 rounded-xl shadow-md flex justify-between items-center transition duration-300 transform hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] active:shadow-lg cursor-pointer border-l-4 border-green-600 dark:border-green-500">
                <span class="font-semibold text-lg text-green-600 dark:text-green-400">Vinyl Pricing ($20/sq ft)</span>
                <span id="vinylPrice" class="text-2xl font-extrabold text-green-700 dark:text-green-500">$0.00</span>
            </div>
            
            <!-- 3D Printed Result Card ($120/sq ft) -->
            <div onclick="showQuotation('3D Printed Sign', 120, document.getElementById('printedPrice').textContent)"
                 class="bg-white dark:bg-gray-700 p-5 rounded-xl shadow-md flex justify-between items-center transition duration-300 transform hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] active:shadow-lg cursor-pointer border-l-4 border-purple-600 dark:border-purple-500">
                <span class="font-semibold text-lg text-purple-600 dark:text-purple-400">3D Printed Pricing ($120/sq ft)</span>
                <span id="printedPrice" class="text-2xl font-extrabold text-purple-700 dark:text-purple-500">$0.00</span>
            </div>
            
            <!-- LED Strip Result Card ($17/meter) -->
            <div onclick="showQuotation('LED Strip Lighting ($17/meter)', 0, document.getElementById('ledStripPrice').textContent)"
                 class="bg-white dark:bg-gray-700 p-5 rounded-xl shadow-md flex justify-between items-center transition duration-300 transform hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] active:shadow-lg cursor-pointer border-l-4 border-amber-600 dark:border-amber-500">
                <span class="font-semibold text-lg text-amber-600 dark:text-amber-400">LED Strip Pricing ($17/meter)</span>
                <span id="ledStripPrice" class="text-2xl font-extrabold text-amber-700 dark:text-amber-500">$0.00</span>
            </div>
        </div>

    </div>

    <!-- Quotation Modal Overlay (Dynamic BG/Text) -->
    <div id="quoteModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-90 dark:bg-opacity-95 flex items-center justify-center p-4 z-50 transition-opacity duration-300" onclick="hideQuotation()">
        <!-- Modal Content. Dynamic BG/Text/Border -->
        <div id="modalContent" 
             class="rounded-xl shadow-2xl w-full max-w-lg p-6 sm:p-8 relative modal-enter 
                    bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-200" 
             onclick="event.stopPropagation()">
            <!-- Close Button -->
            <button onclick="hideQuotation()" class="absolute top-4 right-4 text-gray-500 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition duration-150">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <h3 class="text-2xl font-extrabold text-blue-600 dark:text-blue-400 mb-6 border-b border-gray-300 dark:border-gray-600 pb-2">Quotation</h3>

            <!-- Dynamic Content -->
            <div id="quoteContent" class="space-y-4 text-gray-700 dark:text-gray-300">
                
                <div class="text-xl font-bold text-gray-900 dark:text-gray-100 border-b border-gray-400 dark:border-gray-700 pb-2" id="quoteSignageType"></div>
                
                <p class="font-semibold text-lg pt-2" id="quoteDimsTitle">Sizes (W x H):</p>
                <div class="text-xl font-medium text-gray-600 dark:text-gray-400 ml-4" id="quoteFinalDims"></div>
                
                <div class="pt-4 border-t border-gray-300 dark:border-gray-600">
                    <p class="font-semibold mb-2 text-xl text-green-600 dark:text-green-400">Total Price:</p>
                    <div class="text-4xl font-extrabold text-green-700 dark:text-green-500" id="quoteTotal"></div>
                </div>
            </div>

            <div class="mt-8 pt-4 border-t border-gray-300 dark:border-gray-700 text-sm text-gray-500 dark:text-gray-500 text-center">
                <p>This is an automated quote based on your input dimensions.</p>
            </div>
        </div>
    </div>

    <script>
        // --- Theme Switching Logic ---
        const htmlElement = document.documentElement;
        const sunIcon = document.getElementById('sunIcon');
        const moonIcon = document.getElementById('moonIcon');

        /**
         * Applies the theme class and updates the toggle icon visibility.
         * @param {string} theme 'light' or 'dark'
         */
        function applyTheme(theme) {
            if (theme === 'dark') {
                htmlElement.classList.add('dark');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            } else {
                htmlElement.classList.remove('dark');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            }
            // Save preference to local storage
            localStorage.setItem('theme', theme);
        }

        /**
         * Loads the theme from local storage or system preference.
         */
        function loadTheme() {
            const storedTheme = localStorage.getItem('theme');
            let initialTheme = 'light'; // Default to light mode

            if (storedTheme) {
                // Use stored preference
                initialTheme = storedTheme;
            } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                // Use system preference if no stored preference
                initialTheme = 'dark';
            }
            
            applyTheme(initialTheme);
        }

        /**
         * Toggles between light and dark themes.
         */
        function toggleTheme() {
            const currentTheme = htmlElement.classList.contains('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
        }

        // --- Pricing Calculator Logic (Unchanged) ---
        const CM_PER_INCH = 2.54;
        const MM_PER_INCH = 25.4;
        const INCHES_PER_FOOT = 12;
        
        const LIGHTBOX_ONLY_RATE_50 = 50; 
        const LIGHTBOX_W_BACKLIT_RATE_85 = 85; 
        const BACKLIT_ONLY_RATE = 35; 

        let lastAreaSqFt = 0;
        let lastWidthInput = 0;
        let lastHeightInput = 0;
        
        function convertToInches(value, unit) {
            switch (unit) {
                case 'in': return value;
                case 'ft': return value * INCHES_PER_FOOT;
                case 'cm': return value / CM_PER_INCH;
                case 'mm': return value / MM_PER_INCH;
                default: return 0;
            }
        }

        function convertFromInches(valueInches, targetUnit) {
            switch (targetUnit) {
                case 'ft': return valueInches / INCHES_PER_FOOT;
                case 'cm': return valueInches * CM_PER_INCH;
                case 'mm': return valueInches * MM_PER_INCH;
                default: return valueInches; 
            }
        }

        function showQuotation(signageType, rate, total) {
            const modal = document.getElementById('quoteModal');
            const content = document.getElementById('modalContent');
            
            if (lastAreaSqFt <= 0) {
                // Error message adapted for dynamic colors
                content.innerHTML = `
                    <h3 class="text-2xl font-extrabold text-red-600 dark:text-red-400 mb-6 border-b border-gray-300 dark:border-gray-600 pb-2">错误 (Error)</h3>
                    <p class="text-lg text-gray-700 dark:text-gray-300">请输入有效的正数尺寸后再生成报价 (Please enter valid positive dimensions before generating a quote).</p>
                    <button onclick="hideQuotation()" class="mt-6 w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 transition">关闭 (Close)</button>
                `;
                // Modal specific class adjustments for error state
                content.classList.remove('dark:bg-gray-800', 'bg-white');
                content.classList.add('bg-red-100', 'dark:bg-red-900', 'text-red-900', 'dark:text-white');
                modal.classList.remove('hidden');
                return;
            }
            
            // Reset content classes (in case of prior error)
            content.classList.remove('bg-red-100', 'dark:bg-red-900', 'text-red-900', 'dark:text-white');
            content.classList.add('bg-white', 'dark:bg-gray-800', 'text-gray-900', 'dark:text-gray-200');
            
            document.getElementById('quoteSignageType').textContent = signageType;
            document.getElementById('quoteTotal').textContent = total;
            
            const unitValue = document.getElementById('unit').value;
            const widthInches = convertToInches(lastWidthInput, unitValue);
            const heightInches = convertToInches(lastHeightInput, unitValue);

            const widthInchesDisplay = widthInches % 1 === 0 ? widthInches : widthInches.toFixed(2);
            const heightInchesDisplay = heightInches % 1 === 0 ? heightInches : heightInches.toFixed(2);

            document.getElementById('quoteFinalDims').textContent = 
                `${widthInchesDisplay}'' (W) x ${heightInchesDisplay}'' (H)`;
            
            modal.classList.remove('hidden');
            content.classList.add('modal-enter-active');
            content.classList.remove('modal-enter');
        }

        function hideQuotation() {
            const modal = document.getElementById('quoteModal');
            const content = document.getElementById('modalContent');
            
            content.classList.add('modal-exit-active');
            content.classList.remove('modal-enter-active');

            setTimeout(() => {
                modal.classList.add('hidden');
                content.classList.remove('modal-exit-active');
                content.classList.add('modal-enter'); 
            }, 300); 
        }

        function calculatePricing() {
            const unit = document.getElementById('unit').value;
            const widthValue = parseFloat(document.getElementById('width').value);
            const heightValue = parseFloat(document.getElementById('height').value);
            
            const unitLabelElement = document.getElementById('unit');
            const unitLabelTextMatch = unitLabelElement.options[unitLabelElement.selectedIndex].text.match(/\((.*?)\)/);
            const unitLabelText = unitLabelTextMatch ? unitLabelTextMatch[1] : unit;
            
            document.getElementById('widthUnitLabel').textContent = unitLabelText;
            document.getElementById('heightUnitLabel').textContent = unitLabelText;

            if (isNaN(widthValue) || isNaN(heightValue) || widthValue <= 0 || heightValue <= 0) {
                lastAreaSqFt = 0;
                lastWidthInput = 0;
                lastHeightInput = 0;
                
                document.getElementById('areaDisplay').textContent = '';
                document.getElementById('lightboxOnlyPrice').textContent = '$0.00'; 
                document.getElementById('lightboxStandardPrice').textContent = '$0.00'; 
                document.getElementById('backlitPrice').textContent = '$0.00'; 
                document.getElementById('vinylPrice').textContent = '$0.00';
                document.getElementById('printedPrice').textContent = '$0.00';
                document.getElementById('ledStripPrice').textContent = '$0.00'; 
                
                document.getElementById('w_ft').textContent = '0.00 ft';
                document.getElementById('h_ft').textContent = '0.00 ft';
                document.getElementById('w_cm').textContent = '0.00 cm';
                document.getElementById('h_cm').textContent = '0.00 cm';
                document.getElementById('w_mm').textContent = '0.00 mm';
                document.getElementById('h_mm').textContent = '0.00 mm';
                return;
            }

            const widthInches = convertToInches(widthValue, unit);
            const heightInches = convertToInches(heightValue, unit);

            const w_ft = convertFromInches(widthInches, 'ft');
            const h_ft = convertFromInches(heightInches, 'ft');
            const w_cm = convertFromInches(widthInches, 'cm');
            const h_cm = convertFromInches(heightInches, 'cm');
            const w_mm = convertFromInches(widthInches, 'mm');
            const h_mm = convertFromInches(heightInches, 'mm');

            lastWidthInput = widthValue;
            lastHeightInput = heightValue;

            document.getElementById('w_ft').textContent = `${w_ft.toFixed(2)} ft`;
            document.getElementById('h_ft').textContent = `${h_ft.toFixed(2)} ft`;
            document.getElementById('w_cm').textContent = `${w_cm.toFixed(2)} cm`;
            document.getElementById('h_cm').textContent = `${h_cm.toFixed(2)} cm`;
            document.getElementById('w_mm').textContent = `${w_mm.toFixed(2)} mm`;
            document.getElementById('h_mm').textContent = `${h_mm.toFixed(2)} mm`;
            
            document.getElementById('conversionResults').querySelector('h3').textContent = 
                `Converted Dimensions (for ${widthValue} ${unitLabelText} x ${heightValue} ${unitLabelText})`;

            const areaSqFt = w_ft * h_ft;
            lastAreaSqFt = areaSqFt; 

            const VINYL_RATE = 20;
            const PRINTED_RATE = 120; 
            const LED_STRIP_DIVISOR_W = 39;
            const LED_STRIP_DIVISOR_H = 5;
            const LED_STRIP_MULTIPLIER = 17; 

            const lightboxWBacklitPrice = areaSqFt * LIGHTBOX_W_BACKLIT_RATE_85; 
            const lightboxOnlyPrice50 = areaSqFt * LIGHTBOX_ONLY_RATE_50; 
            const backlitOnlyPrice = areaSqFt * BACKLIT_ONLY_RATE;
            const vinylPrice = areaSqFt * VINYL_RATE;
            const printedPrice = areaSqFt * PRINTED_RATE; 
            
            const baseWValue = (widthInches / LED_STRIP_DIVISOR_W);
            const baseHValue = (heightInches / LED_STRIP_DIVISOR_H);
            const ledStripBaseValue = baseWValue * baseHValue; 
            const ledStripPrice = ledStripBaseValue * LED_STRIP_MULTIPLIER; 

            document.getElementById('areaDisplay').textContent = ''; 
            
            document.getElementById('lightboxOnlyPrice').textContent = `$${lightboxWBacklitPrice.toFixed(2)}`;
            document.getElementById('lightboxStandardPrice').textContent = `$${lightboxOnlyPrice50.toFixed(2)}`; 
            document.getElementById('backlitPrice').textContent = `$${backlitOnlyPrice.toFixed(2)}`; 
            document.getElementById('vinylPrice').textContent = `$${vinylPrice.toFixed(2)}`;
            document.getElementById('printedPrice').textContent = `$${printedPrice.toFixed(2)}`;
            document.getElementById('ledStripPrice').textContent = `$${ledStripPrice.toFixed(2)}`; 
        }

        /**
         * Runs the page entrance animation and initializes the page.
         */
        function initializePage() {
            // Load theme first, which sets the dark/light class
            loadTheme();
            
            const container = document.getElementById('mainContainer');
            
            // Add transition class for the animation effect
            container.classList.add('page-transition');
            
            // Trigger the animation
            setTimeout(() => {
                container.classList.remove('page-enter-start');
                container.classList.add('page-enter-end');
            }, 50); 
            
            // Perform initial calculation
            calculatePricing();
        }

        // Call the initialization function when the window loads
        window.onload = initializePage;
    </script>
</body>
</html>